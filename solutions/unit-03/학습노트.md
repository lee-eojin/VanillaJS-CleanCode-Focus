# Unit-03 학습 노트

## 정규표현식 `/^\/\/(.)\n(.*)$/` 분석

이번 문제에서 가장 어려웠던 부분은 정규표현식이었다. `/^\/\/(.)\n(.*)$/`를 처음 봤을 때 슬래시와 괄호가 뒤섞여 있어서 무슨 의미인지 파악하기 어려웠다.

맨 앞과 맨 뒤의 `/`는 정규표현식의 구분자다. 실제 패턴은 `^\/\/(.)\n(.*)$` 이 부분이다.

- `^`: 문자열의 시작
- `\/\/`: `//` 두 글자 (슬래시는 `\`로 이스케이프 필요)
- `(.)`: 아무 글자 한 글자 (괄호는 캡처 그룹)
- `\n`: 줄바꿈 문자
- `(.*)`: 나머지 전부 (`.`은 아무 글자, `*`는 0개 이상)
- `$`: 문자열의 끝

즉, `//;` + 줄바꿈 + `1;2;3` 형식에서 `;`와 `1;2;3`를 각각 추출하는 패턴이다.

```js
const match = text.match(CUSTOM_DELIMITER_PATTERN);
const delimiter = match[1];  // 첫 번째 캡처 그룹 (구분자)
const numbers = match[2];     // 두 번째 캡처 그룹 (숫자들)
```

`match[0]`은 전체 매칭된 문자열, `match[1]`과 `match[2]`는 각 괄호에 잡힌 부분이다. 괄호로 감싼 이유는 나중에 따로 꺼내 쓰기 위해서다.

## 이스케이프 문자 `\n`

`\n`은 코드에서 줄바꿈을 표현하는 특수 문자다.

```js
"//;\n1;2;3"
```

이 문자열은 실제로 두 줄처럼 동작한다.
```
//;
1;2;3
```

문자열을 따옴표로 감싸는데 중간에 진짜 엔터를 치면 문자열이 끊어진다. 그래서 `\n`이라는 약속된 표현을 쓴다. 카톡에서 시프트+엔터로, HTML에서 `<br>` 태그로 줄바꿈하는 것처럼, 자바스크립트에서는 `\n`으로 표현하는 것이다.

`\`로 시작하는 문자들을 이스케이프 문자라고 부른다. `\n`은 줄바꿈, `\t`는 탭, `\\`는 백슬래시 자체를 의미한다.

## map() 메서드로 배열 변환하기

```js
const numbers = tokens.map(toNumber);
```

`map()`은 배열의 각 요소를 변환할 때 사용한다. 괄호 없이 `toNumber`로 쓰는 이유는 함수 자체를 전달하기 위해서다. `map()`이 받아서 각 요소마다 실행한다.

for문으로도 같은 결과를 만들 수 있다.

```js
const numbers = [];
for (const token of tokens) {
  numbers.push(toNumber(token));
}
```

하지만 `map()`이 간결하고, "각 요소를 변환한다"는 의도가 명확하다. 또한 원본 배열을 건드리지 않고 새로운 배열을 반환한다. 이런 방식을 불변성을 지킨다고 하는데, 원본이 바뀌면 예상치 못한 곳에서 문제가 생길 수 있다.

## 커스텀 구분자 처리 로직

이번 문제의 핵심은 두 가지 모드를 구분하는 것이었다.

```js
if (text === "") {
  return [];
}

if (text.startsWith("//")) {
  const match = text.match(CUSTOM_DELIMITER_PATTERN);
  const delimiter = match[1];
  const numbers = match[2];
  return numbers.split(delimiter);
} else {
  return text.split(DEFAULT_DELIMITER);
}
```

`startsWith()` 메서드로 문자열이 `//`로 시작하는지 확인한다. `text[0] === '/' && text[1] === '/'`로도 가능하지만 `startsWith()`가 훨씬 읽기 쉽다.

빈 문자열은 맨 처음에 체크해서 조기 return 한다. 예외 케이스를 먼저 처리하면 나머지 코드가 간결해진다. else if로 계속 이어가면 코드가 복잡해진다.

## 매직 넘버를 상수로 정의하기

```js
const DEFAULT_DELIMITER = /,|:/;
const CUSTOM_DELIMITER_PATTERN = /^\/\/(.)\n(.*)$/;
```

코드에 `/,|:/` 같은 값을 직접 쓰지 않고 상수로 정의했다.

상수로 정의하면 의미가 명확해진다. `/,|:/`보다 `DEFAULT_DELIMITER`가 "기본 구분자"라는 의도를 분명하게 드러낸다. 수정할 때도 한 곳만 바꾸면 되고, 오타를 방지할 수 있다.

코드에 갑자기 나타나는 숫자나 문자열을 매직 넘버(또는 매직 문자열)라고 부른다. 왜 이 값이 나왔는지 모르니까 마법처럼 느껴진다는 의미다. 상수로 정의하면 그 값이 왜 필요한지, 어떤 의미인지 명확해진다.

## 함수를 작게 나누니 테스트하기 쉬웠다

- `parseTokens()`: 문자열을 토큰 배열로
- `toNumber()`: 문자열을 숫자로
- `sum()`: 숫자 배열을 합으로
- `add()`: 전체 통합

각 함수가 한 가지 일만 하니까 어디서 문제가 생겼는지 찾기 쉬웠다. 테스트도 각 함수별로 따로 할 수 있어서 디버깅이 수월했다.

```js
function add(text) {
  const tokens = parseTokens(text);
  const numbers = tokens.map(toNumber);
  return sum(numbers);
}
```

`add()` 함수가 딱 3줄로 끝났다. 각 줄이 하나의 단계를 나타낸다. 문자열 → 토큰 → 숫자 → 합. 흐름이 한눈에 보인다. 주석 없이도 코드만 읽으면 무슨 일을 하는지 바로 이해된다.

작은 함수들을 조합해서 큰 기능을 만드는 방식이다. 각 함수가 이름만 봐도 뭘 하는지 알 수 있고, 재사용도 가능하다. 레고 블록처럼 조립할 수 있는 코드가 됐다.
